(function(b){var c="../static/scripts/recorderWorker.js";var a=function(g,d){var f=d||{};var h=f.bufferLen||4096;this.context=g.context;this.node=this.context.createScriptProcessor(h,2,2)||this.context.createJavaScriptNode(h,2,2);var i=new Worker(f.workerPath||c);i.postMessage({command:"init",config:{sampleRate:this.context.sampleRate}});var e=false,j;this.node.onaudioprocess=function(k){if(!e){return}i.postMessage({command:"record",buffer:[k.inputBuffer.getChannelData(0),k.inputBuffer.getChannelData(1)]})};this.configure=function(k){for(var l in k){if(k.hasOwnProperty(l)){f[l]=k[l]}}};this.record=function(){e=true};this.stop=function(){e=false};this.clear=function(){i.postMessage({command:"clear"})};this.getBuffer=function(k){j=k||f.callback;i.postMessage({command:"getBuffer"})};this.exportWAV=function(k,l){j=k||f.callback;l=l||f.type||"audio/wav";if(!j){throw new Error("Callback not set")}i.postMessage({command:"exportWAV",type:l})};i.onmessage=function(l){var k=l.data;j(k)};g.connect(this.node);this.node.connect(this.context.destination)};a.forceDownload=function(e,d){var f=(b.URL||b.webkitURL).createObjectURL(e);var h=b.document.createElement("a");h.href=f;h.download=d||"output.wav";var g=document.createEvent("Event");g.initEvent("click",true,true);h.dispatchEvent(g)};b.Recorder=a})(window);